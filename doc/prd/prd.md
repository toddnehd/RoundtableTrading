# Product Requirements Document (PRD)
# RoundtableTrading - 멀티 에이전틱 주식 트레이딩 시스템

**버전**: v0.1 (Draft)  
**작성일**: 2026-01-27  
**작성자**: Project Owner  
**문서 상태**: Draft - Review 필요  
**최종 업데이트**: 2026-01-27

---

## 📋 문서 개정 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| 0.1 | 2026-01-27 | Owner | 초안 작성 |
| 0.2 | 2026-01-27 | Owner | 타임프레임 전략 추가, 로컬 LLM 옵션 추가 |

---

## 1. Executive Summary (개요)

### 1.1 제품 개요

**제품명**: RoundtableTrading  
**한 줄 요약**: AI 에이전트들이 원탁 회의처럼 토론하여 투자 의사결정을 내리는 주식 트레이딩 시스템

**핵심 가치 제안**:
- 단일 AI가 아닌 **다수의 전문 AI 에이전트**가 서로 다른 관점에서 분석
- 에이전트 간 **토론 과정을 투명하게 공개**하여 의사결정 신뢰성 확보
- 단계적 진화(분석 도구 → 반자동 → 완전 자동)로 **리스크 최소화**

### 1.2 주요 이해관계자

- **Product Owner**: 개인 투자자, 시스템 개발자
- **Primary User**: 본인 (Phase 1 개인 사용)
- **Secondary User**: 향후 일반 투자자 확대 (Phase 2-3)

### 1.3 문서 목적

본 문서는 RoundtableTrading 시스템의 Phase 1(분석 보조 도구) 개발을 위한 제품 요구사항을 정의합니다.

---

## 2. Product Vision & Goals (제품 비전 및 목표)

### 2.1 제품 비전

> "AI 에이전트들의 집단 지성을 통해, 개인 투자자도 기관 수준의 분석과 의사결정을 할 수 있는 시스템"

### 2.2 해결하고자 하는 문제

**현재 개인 투자자의 Pain Points**:

1. **정보 과부하**: 뉴스, 차트, 재무제표, 공시 등 분석할 데이터가 너무 많음
2. **편향된 판단**: 단일 관점(기술적 or 펀더멘털)에만 의존하여 리스크 증가
3. **감정적 의사결정**: 공포/탐욕에 의한 충동적 매매
4. **시간 부족**: 직장인은 장중 모니터링 불가능
5. **불투명한 AI 추천**: 기존 AI 서비스는 "왜 그런 판단을 했는지" 알 수 없음

**RoundtableTrading의 해결 방안**:

1. **다각도 분석**: 5개 전문 에이전트가 각자의 영역에서 분석
2. **균형잡힌 판단**: 에이전트 간 토론으로 편향 최소화
3. **투명한 의사결정**: 토론 과정 전체 공개
4. **자동화**: 24시간 모니터링 및 실시간 알림
5. **설명 가능성**: 각 에이전트의 근거를 명확히 제시

### 2.3 타겟 사용자

#### Primary Persona: 직장인 개인 투자자

**인구통계학**:
- 연령: 30-45세
- 직업: 직장인 (IT, 금융, 일반 사무직)
- 투자 자산: 1천만원 ~ 1억원
- 투자 경험: 3년 이상

**특징**:
- 기본적인 주식 용어는 알고 있음 (PER, PBR, ROE 등)
- 차트 보는 법은 알지만 깊이 있는 분석은 어려움
- 장중에는 업무 중이라 실시간 모니터링 불가
- 저녁에 분석하고 익일 전략 수립

**Goals**:
- 연 수익률 15% 이상 (KOSPI 평균 대비 초과 수익)
- MDD(최대 낙폭) 15% 이내로 관리
- 감정적 매매 줄이기
- 시간 절약 (분석 시간 50% 감축)

**Pain Points**:
- "삼성전자를 살까 말까 고민하는데, 여러 요소를 종합적으로 판단하기 어렵다"
- "차트는 좋은데 실적이 안 좋으면 어떻게 해야 할지 모르겠다"
- "손절해야 하는데 자꾸 '조금만 더 기다리면...' 하다가 손실 커진다"
- "밤에 분석하고 아침에 출근하면 상황이 바뀌어 있어서 당황스럽다"

### 2.4 Success Metrics (성공 지표)

#### Phase 1 목표 (2개월 개발 후)

**정량적 지표**:
- ✅ **백테스팅 샤프 비율 ≥ 1.5**
- ✅ **승률 ≥ 60%** (추천 종목의 2주 후 수익률 기준)
- ✅ **KOSPI 대비 초과 수익률 ≥ 5%p** (연환산)
- ✅ **MDD ≤ 15%**

**정성적 지표**:
- ✅ 에이전트 토론 과정이 이해 가능하고 합리적이라고 판단
- ✅ 최소 1개 종목에서 실제 추천 → 수익 발생 경험
- ✅ 분석 시간 50% 이상 절감

**기술적 지표**:
- ✅ API 응답 시간 < 30초 (종목 1개 분석 기준)
- ✅ 데이터 수집 성공률 ≥ 95%
- ✅ 시스템 가동률 ≥ 99% (장 시간 기준)

---

## 3. Market Analysis (시장 분석)

### 3.1 시장 크기

**TAM (Total Addressable Market)**: 한국 전체 주식 투자자
- 약 1,400만 명 (2024년 기준)
- 잠재 시장 규모: 연 1.4조원 (월 1만원 구독 가정)

**SAM (Serviceable Addressable Market)**: 알고리즘/AI 트레이딩에 관심 있는 투자자
- 약 100만 명 (추정)
- 실현 가능 시장 규모: 연 1,000억원

**SOM (Serviceable Obtainable Market)**: Phase 3까지 도달 가능한 시장
- 1만 명 (시장 점유율 1%)
- 초기 목표 시장 규모: 연 10억원

### 3.2 경쟁사 분석

| 서비스 | 특징 | 강점 | 약점 | 차별점 |
|--------|------|------|------|--------|
| **QuantConnect** | 알고리즘 트레이딩 플랫폼 | 강력한 백테스팅, 글로벌 시장 | 코딩 필요, 한국 시장 미약 | ✅ 한국 시장 특화 |
| **증권사 AI 추천** | 로보어드바이저 | 무료, 증권사 신뢰 | 블랙박스, 단순 추천만 | ✅ 투명한 토론 과정 |
| **트레이딩뷰** | 차트 분석 | 강력한 차트 도구 | 수동 분석 필요 | ✅ AI 자동 분석 |
| **네이버 증권** | 종합 정보 제공 | 무료, 데이터 풍부 | 분석 없음 | ✅ 에이전트 토론 |

**핵심 차별점**:
1. **멀티 에이전트 토론 메커니즘**: 단일 AI가 아닌 5개 전문 에이전트의 협업
2. **투명성**: 토론 과정 전체 공개, 반대 의견도 표시
3. **한국 시장 특화**: KOSPI/KOSDAQ 데이터 최적화
4. **단계적 진화**: 분석 도구 → 자동매매로 자연스러운 전환

### 3.3 시장 트렌드

**기회 요인**:
- ✅ AI/LLM 기술의 급속한 발전 (Claude, GPT-4 등)
- ✅ 개인 투자자 증가 (특히 2030세대)
- ✅ 알고리즘 트레이딩에 대한 관심 증가
- ✅ 오픈 API 확대 (한국투자증권, 이베스트 등)

**위협 요인**:
- ⚠️ 증권사의 무료 AI 서비스 확대
- ⚠️ 규제 강화 가능성
- ⚠️ 시장 하락 시 AI에 대한 신뢰 하락

---

## 4. Product Scope (제품 범위)

### 4.1 Phase 1: 분석 보조 도구 (2개월)

#### In-Scope (포함)

**핵심 기능**:

**F1. 멀티 에이전트 분석 시스템** (P0 - 필수)
- 5개 전문 에이전트 구현:
  1. 기업 가치 분석 에이전트 (펀더멘털)
  2. 기술적 분석 에이전트 (차트/지표)
  3. 시장 분석 에이전트 (뉴스/섹터 트렌드)
  4. 리스크 관리 에이전트 (손절/포지션 관리)
  5. 조정자 에이전트 (최종 의사결정)

**F2. 토론 메커니즘** (P0 - 필수)
- 5단계 토론 프로토콜:
  1. 개별 분석 단계
  2. 의견 제시 단계 (점수화)
  3. 토론 라운드 (최대 3회)
  4. 합의 도출 (가중 투표)
  5. 최종 결정 (조정자)
- 합의 실패 처리 (관찰 리스트, 소량 진입 등)

**F3. 데이터 수집 및 처리** (P0 - 필수)
- pykrx를 통한 과거 데이터 수집 (3년치)
- 한국투자증권 API 연동 (실시간 시세)
- DART OpenAPI 연동 (재무제표, 공시)
- 데이터 품질 검증 파이프라인

**F4. 백테스팅 엔진** (P0 - 필수)
- 과거 3년 데이터로 전략 검증
- 거래 비용 반영 (수수료 0.015%, 세금 0.23%, 슬리피지 0.1%)
- Walk-forward 분석
- 성과 지표 계산 (샤프 비율, MDD, 승률 등)

**F5. 분석 리포트 생성** (P0 - 필수)
- 종목별 종합 분석 리포트
- 에이전트별 의견 및 근거
- 토론 과정 요약
- 매수/매도 신호 (진입가, 목표가, 손절가)

**F6. Streamlit 대시보드** (P0 - 필수)
- 종목 검색 및 분석 요청
- 실시간 분석 진행 상황 표시
- 토론 과정 시각화 (텍스트 기반)
- 차트 및 지표 표시
- 백테스팅 결과 대시보드

**F7. 비용 최적화** (P1 - 중요)
- 2단계 스크리닝 아키텍처:
  1. 규칙 기반 1차 필터링 (Python)
  2. LLM 기반 심층 분석 (소수 종목만)
- 프롬프트 캐싱
- 에이전트별 LLM 티어링

**F8. 로깅 및 모니터링** (P1 - 중요)
- 모든 에이전트 의견 DB 저장
- 토론 과정 전체 기록
- 성과 추적 (예측 vs 실제)
- 에러 로깅

#### Out-of-Scope (제외)

**Phase 1에서 제외되는 기능**:
- ❌ 실제 주문 실행 (Phase 2)
- ❌ 실시간 장중 모니터링 (Phase 2)
- ❌ 포트폴리오 자동 리밸런싱 (Phase 2)
- ❌ 모바일 알림 (Phase 2)
- ❌ 사용자 계정 시스템 (Phase 2)
- ❌ 다수 사용자 지원 (Phase 2)
- ❌ 미국 주식, 암호화폐 등 (Phase 3)

### 4.2 Future Phases (향후 계획)

**Phase 2: 반자동 매매 (3-6개월)**
- 시뮬레이션 계좌 (Paper Trading)
- 승인 기반 자동 주문
- 실시간 장중 모니터링
- 모바일 알림 (텔레그램)
- 소액 실전 테스트

**Phase 3: 완전 자동매매 (6개월+)**
- 24시간 자율 운영
- 멀티 전략 운영
- 다수 사용자 지원
- 구독 모델 도입
- 해외 시장 확장

---

## 5. Functional Requirements (기능 요구사항)

### 5.1 F1. 멀티 에이전트 분석 시스템

#### F1.1 기업 가치 분석 에이전트

**설명**: 기업의 펀더멘털, 재무제표, 밸류에이션, 미래 성장성을 분석

**사용자 스토리**:
```
As a 투자자,
I want to 기업의 재무 건전성과 성장 가능성을 AI가 분석해주길,
So that 저평가/고평가 여부를 판단할 수 있다.
```

**입력**:
- 종목 코드
- 재무제표 데이터 (3년치)
- 밸류에이션 지표 (PER, PBR, ROE 등)
- 업종 평균 지표
- 최근 뉴스 (선택)

**출력**:
- 의견: 매수(긍정) / 중립 / 매도(부정)
- 신뢰도 점수: 0-100점
- 핵심 근거 3개 (간결하게)
- 목표 주가 (선택)

**Acceptance Criteria**:
- Given 삼성전자(005930) 분석 요청
- When 최근 3년 재무제표와 PER 15.2를 제공
- Then "긍정(85점): PER 15는 업종 평균 18 대비 저평가, 실적 개선 추세, ROE 10% 이상 우량" 형태로 출력

**우선순위**: P0 (Must-have)

---

#### F1.2 기술적 분석 에이전트

**설명**: 차트 패턴, 기술적 지표, 거래량을 분석하여 단기 가격 움직임 예측

**사용자 스토리**:
```
As a 투자자,
I want to 차트와 기술적 지표를 AI가 종합 분석해주길,
So that 매수/매도 타이밍을 결정할 수 있다.
```

**입력**:
- 종목 코드
- 일봉 데이터 (60일치)
- 기술적 지표:
  - 이동평균선 (5일, 20일, 60일)
  - RSI (14일)
  - MACD
  - 볼린저 밴드
  - 거래량 추세

**출력**:
- 의견: 매수 / 중립 / 매도
- 신뢰도 점수: 0-100점
- 핵심 근거 3개
- 진입 시점 추천 (예: "5일선 돌파 시")

**Acceptance Criteria**:
- Given 삼성전자 차트 분석 요청
- When 골든크로스 + RSI 50 + 거래량 증가 패턴 감지
- Then "매수(80점): 5일선이 20일선 상향 돌파(골든크로스), RSI 50으로 과열 아님, 거래량 평소의 1.5배" 출력

**우선순위**: P0 (Must-have)

---

#### F1.3 시장 분석 에이전트

**설명**: 실시간 뉴스, 섹터 트렌드, 환율 등 거시적 요인 분석

**사용자 스토리**:
```
As a 투자자,
I want to 시장 전체 흐름과 해당 종목의 섹터 트렌드를 AI가 분석해주길,
So that 큰 그림에서 투자 판단을 할 수 있다.
```

**입력**:
- 종목 코드
- 해당 종목의 섹터/업종
- 최근 1주일 뉴스
- KOSPI/KOSDAQ 지수 추이
- 환율 (USD/KRW)
- 섹터별 수급 동향

**출력**:
- 의견: 긍정 / 중립 / 부정
- 신뢰도 점수: 0-100점
- 핵심 근거 3개
- 시장 리스크 경고 (있을 경우)

**Acceptance Criteria**:
- Given 삼성전자 시장 분석 요청 (반도체 섹터)
- When 반도체 수출 통계 개선 + 미국 반도체 지원법 통과 뉴스
- Then "긍정(78점): 반도체 업황 회복 신호, 미국 정책 우호적, 환율 안정" 출력

**우선순위**: P0 (Must-have)

---

#### F1.4 리스크 관리 에이전트

**설명**: 포트폴리오 위험도 평가, 손절가 제안, 포지션 크기 결정

**사용자 스토리**:
```
As a 투자자,
I want to 이 종목을 매수했을 때의 리스크를 AI가 평가해주길,
So that 안전한 포지션 크기와 손절가를 설정할 수 있다.
```

**입력**:
- 종목 코드
- 현재 포트폴리오 (보유 종목, 비중)
- 종목의 변동성 (베타)
- 종목의 유동성 (거래량)
- 최근 최대 낙폭

**출력**:
- 최대 포지션 크기: X% (총 자산 대비)
- 권장 손절가: -Y%
- 리스크 점수: 0-100점 (낮을수록 안전)
- 주의사항

**Acceptance Criteria**:
- Given 삼성전자 리스크 평가 요청
- When 변동성 낮음(베타 0.8) + 유동성 높음 + 포트폴리오에 IT 섹터 30% 보유 중
- Then "최대 포지션 15%, 손절가 -7%, 리스크 점수 30점(낮음), 주의: IT 섹터 집중도 이미 높음" 출력

**우선순위**: P0 (Must-have)

---

#### F1.5 조정자 에이전트

**설명**: 모든 에이전트의 의견을 종합하여 최종 의사결정

**사용자 스토리**:
```
As a 투자자,
I want to 여러 에이전트의 의견이 충돌할 때 최종 판단을 AI가 내려주길,
So that 명확한 투자 방향을 얻을 수 있다.
```

**입력**:
- 모든 에이전트의 의견 (4개)
- 각 에이전트의 과거 성과 (가중치)
- 현재 시장 환경

**출력**:
- 최종 의견: 매수 추천 / 관찰 / 매수 보류 / 매도 추천
- 종합 신뢰도: 0-100점
- 진입가: X원
- 목표가: Y원 (+Z%)
- 손절가: W원 (-V%)
- 포지션 크기: 총 자산의 U%
- 주의사항

**Acceptance Criteria**:
- Given 4개 에이전트 의견 수집 완료
- When 펀더멘털(85점, 긍정), 기술적(80점, 긍정), 시장(78점, 긍정), 리스크(65점, 중립)
- Then "매수 추천, 신뢰도 87%, 진입가 70,000원, 목표가 78,000원(+11%), 손절가 66,000원(-6%), 포지션 15%" 출력

**우선순위**: P0 (Must-have)

---

### 5.2 F2. 토론 메커니즘

#### F2.1 5단계 토론 프로토콜

**설명**: 에이전트 간 구조화된 토론 과정

**단계별 세부사항**:

**1단계: 개별 분석**
- 각 에이전트가 독립적으로 분석
- 타임아웃: 에이전트당 30초
- 병렬 처리 (동시 실행)

**2단계: 의견 제시**
- 점수화된 의견 제출 (0-100점)
- 근거 3개 명시
- 포맷 검증

**3단계: 토론 라운드** (조건부)
- 트리거 조건: 의견 표준편차 > 20점
- 최대 3라운드
- 각 라운드 타임아웃: 20초
- 에이전트는 다른 에이전트 의견을 보고 재평가

**4단계: 합의 도출**
- 가중 투표:
  ```
  최종 점수 = Σ(에이전트 점수 × 가중치)
  가중치 = 에이전트 과거 성과 기반 (초기 1.0)
  ```
- 합의 수준 판단:
  - ≥ 80점: 강한 합의 (표준 포지션)
  - 60-79점: 약한 합의 (축소 포지션)
  - < 60점: 합의 실패 (보류)

**5단계: 최종 결정**
- 조정자가 종합 판단
- 구체적 파라미터 도출

**Acceptance Criteria**:
- Given 5개 에이전트 분석 시작
- When 의견 편차 큼 (80, 75, 85, 50 → 표준편차 14.3 < 20)
- Then 토론 라운드 생략하고 바로 합의 도출 단계로

**우선순위**: P0 (Must-have)

---

#### F2.2 합의 실패 처리

**설명**: 에이전트 간 의견이 크게 갈릴 때의 대응

**처리 옵션**:

1. **판단 보류**: 신뢰도 < 60점
   - 분석 결과만 제공, 추천하지 않음
   - 사용자에게 불확실성 명확히 전달

2. **관찰 리스트 등록**: 신뢰도 50-59점
   - 매일 경량 재평가
   - 조건 변화 시 재토론 트리거

3. **소량 진입**: 신뢰도 60-69점
   - 표준 포지션의 50% (예: 15% → 7.5%)
   - 손절가 타이트하게 (-7% → -5%)

**Acceptance Criteria**:
- Given 최종 신뢰도 55점
- When 합의 실패 (에이전트 의견 대립)
- Then "판단 보류, 관찰 리스트 등록. 이유: 펀더멘털은 긍정이나 기술적으로 과열 신호" 출력

**우선순위**: P0 (Must-have)

---

### 5.3 F3. 데이터 수집 및 처리

#### F3.1 pykrx 데이터 수집

**설명**: 과거 주가, 재무제표, 수급 데이터 수집

**수집 항목**:
- 일봉 데이터 (3년치): 시가, 고가, 저가, 종가, 거래량
- 재무제표 (최근 12분기): 매출, 영업이익, 순이익, 자산, 부채 등
- 밸류에이션 지표: PER, PBR, ROE, 배당수익률
- 수급 데이터: 개인/기관/외국인 순매수

**데이터 검증**:
```python
def validate_stock_data(df):
    checks = [
        ("결측치", df.isnull().sum().sum() == 0),
        ("가격 이상", (df['종가'].pct_change().abs() < 0.3).all()),
        ("거래량 0", (df['거래량'] > 0).all()),
        ("중복", not df.duplicated(subset=['날짜']).any())
    ]
    return all([result for _, result in checks]), checks
```

**에러 처리**:
- 크롤링 실패 시 3회 재시도
- 재시도 실패 시 에러 로깅 및 사용자 알림
- 부분 데이터로도 분석 가능 시 진행 (불확실성 표시)

**Acceptance Criteria**:
- Given 삼성전자(005930) 데이터 수집 요청
- When pykrx 호출
- Then 3년치 일봉 데이터(약 720행) 반환, 검증 통과

**우선순위**: P0 (Must-have)

---

#### F3.2 한국투자증권 API 연동

**설명**: 실시간 시세 조회

**연동 기능**:
- 현재가 조회
- 호가 조회
- 당일 체결 내역

**API 제한 대응**:
- Rate Limit: 초당 5회
- 캐싱: 동일 종목 1초 내 재요청 시 캐시 반환

**Acceptance Criteria**:
- Given 삼성전자 현재가 조회
- When 한국투자증권 API 호출
- Then 3초 이내 현재가 반환

**우선순위**: P0 (Must-have)

---

#### F3.3 DART OpenAPI 연동

**설명**: 재무제표, 공시 수집

**수집 항목**:
- 분기/연간 재무제표
- 주요 공시 (유상증자, M&A, 배당 등)

**Acceptance Criteria**:
- Given 삼성전자 재무제표 요청
- When DART API 호출
- Then 최근 12분기 재무제표 반환

**우선순위**: P1 (Should-have)

---

### 5.4 F4. 백테스팅 엔진

#### F4.1 과거 데이터 시뮬레이션

**설명**: 과거 3년 데이터로 전략 성과 검증

**시뮬레이션 파라미터**:
- 초기 자금: 1억원
- 최대 동시 보유 종목: 10개
- 단일 종목 최대 비중: 20%
- 거래 비용:
  - 매수 수수료: 0.015%
  - 매도 수수료: 0.015%
  - 증권거래세: 0.23%
  - 슬리피지: 0.1%

**Walk-forward 분석**:
```
전체 3년 데이터 분할:
- Training: 2년 (전략 학습)
- Validation: 6개월 (파라미터 조정)
- Test: 6개월 (최종 검증)
```

**Acceptance Criteria**:
- Given 전략 백테스팅 실행
- When 3년 데이터 입력
- Then 샤프 비율, MDD, 승률, 연 수익률 등 출력

**우선순위**: P0 (Must-have)

---

#### F4.2 성과 지표 계산

**설명**: 전략의 성과를 다각도로 평가

**지표 목록**:
```python
metrics = {
    "총 수익률": (최종 자산 - 초기 자산) / 초기 자산,
    "연 수익률": 총 수익률을 연환산,
    "샤프 비율": (연 수익률 - 무위험 수익률) / 변동성,
    "MDD": 최대 낙폭,
    "승률": 수익 거래 / 전체 거래,
    "평균 수익": 수익 거래의 평균 수익률,
    "평균 손실": 손실 거래의 평균 손실률,
    "손익비": 평균 수익 / 평균 손실,
    "거래 횟수": 총 매매 횟수
}
```

**비교 기준**:
- KOSPI Buy & Hold 수익률
- 업종별 ETF 수익률

**Acceptance Criteria**:
- Given 백테스팅 완료
- When 성과 계산
- Then 샤프 비율 1.5 이상 시 "목표 달성" 표시

**우선순위**: P0 (Must-have)

---

### 5.5 F5. 분석 리포트 생성

#### F5.1 종목별 종합 리포트

**설명**: 에이전트 분석 결과를 종합한 보고서

**리포트 구조**:
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
삼성전자 (005930) 분석 결과
신뢰도: 87% | 최종 결정: 매수 추천
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 찬성 (4명)
├─ 기업가치: 긍정 (85점)
│  └─ PER 15 역사적 저평가, 실적 개선
├─ 기술적: 긍정 (80점)
│  └─ 골든크로스, 거래량 증가
├─ 시장: 긍정 (78점)
│  └─ 반도체 업황 회복 신호
└─ 리스크: 중립 (65점)
   └─ 변동성 낮음, 유동성 우수

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
조정자 최종 판단
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
매수 추천: 70,000원
목표가: 78,000원 (+11.4%)
손절가: 66,000원 (-5.7%)
포지션: 총 자산의 15%

⚠️ 주의사항: 단기 과열 가능성.
분할 매수 권장 (3회)
```

**Acceptance Criteria**:
- Given 분석 완료
- When 리포트 생성
- Then 위 포맷으로 마크다운 출력

**우선순위**: P0 (Must-have)

---

### 5.6 F6. Streamlit 대시보드

#### F6.1 메인 화면

**레이아웃**:
```
┌─────────────────────────────────────────┐
│ 🏛️ RoundtableTrading                    │
├─────────────────────────────────────────┤
│ 종목 검색: [삼성전자    ] [분석 시작]    │
├─────────────────────────────────────────┤
│ 📊 분석 진행 상황                        │
│ ✅ 데이터 수집 완료                      │
│ ⏳ 에이전트 분석 중... (3/5)            │
├─────────────────────────────────────────┤
│ 🗣️ 토론 과정                            │
│ [라이브 업데이트]                        │
├─────────────────────────────────────────┤
│ 📈 차트 & 지표                           │
│ [60일 차트 + 거래량]                     │
├─────────────────────────────────────────┤
│ 📄 최종 리포트                           │
│ [에이전트 의견 + 조정자 결정]            │
└─────────────────────────────────────────┘
```

**기능**:
- 종목 코드 또는 이름으로 검색
- 실시간 진행 상황 표시
- 분석 완료 시 자동 리포트 표시

**Acceptance Criteria**:
- Given Streamlit 앱 실행
- When 삼성전자 검색 및 분석 시작
- Then 30초 내 리포트 출력

**우선순위**: P0 (Must-have)

---

#### F6.2 백테스팅 대시보드

**화면 구성**:
- 누적 수익률 차트 (vs KOSPI)
- 주요 지표 카드 (샤프 비율, MDD 등)
- 거래 내역 테이블
- 월별 수익률 히트맵

**Acceptance Criteria**:
- Given 백테스팅 실행
- When 대시보드 접근
- Then 성과 지표 및 차트 표시

**우선순위**: P0 (Must-have)

---

### 5.7 F7. 비용 최적화

#### F7.1 2단계 스크리닝

**설명**: LLM 호출 최소화를 위한 사전 필터링

**1단계: 규칙 기반 필터링** (Python, 비용 $0)
```python
def rule_based_filter(ticker):
    # 기본 조건 체크
    if market_cap < 1000억: return False  # 시가총액
    if daily_volume < 100만주: return False  # 거래량
    if PER < 0 or PER > 100: return False  # 밸류에이션
    
    # 기술적 지표 체크
    if RSI > 70 or RSI < 30: return False  # 과열/과매도
    
    return True
```

**2단계: LLM 분석** (Claude, 통과된 종목만)
- 전체 에이전트 토론 진행
- 종합 리포트 생성

**효과**:
- 2,000개 종목 → 1단계 후 100개 → 2단계 분석
- 비용 절감: 95%

**Acceptance Criteria**:
- Given 전체 KOSPI 종목 스크리닝
- When 1단계 필터링
- Then 100개 이하로 축소

**우선순위**: P1 (Should-have)

---

## 6. Non-Functional Requirements (비기능 요구사항)

### 6.1 성능 (Performance)

| 항목 | 목표 | 측정 방법 |
|------|------|-----------|
| 종목 1개 분석 시간 | < 30초 | 시작~리포트 생성 |
| 백테스팅 (3년 데이터) | < 5분 | 실행~결과 출력 |
| API 응답 시간 | < 3초 | 시세 조회 기준 |
| Streamlit 페이지 로드 | < 2초 | 초기 화면 로드 |

### 6.2 확장성 (Scalability)

**Phase 1 (단일 사용자)**:
- 동시 분석 종목 수: 1개
- 백테스팅 동시 실행: 1개

**Phase 2 이후 고려사항**:
- 다수 사용자 지원
- Redis를 통한 분산 처리
- 에이전트 워커 풀

### 6.3 가용성 (Availability)

**Phase 1 목표**:
- Uptime: 95% (개인 사용이므로 완화)
- 장 시간(09:00-15:30) 가동률: 99%

**장애 대응**:
- LLM API 오류 시 재시도 (3회)
- 데이터 수집 실패 시 캐시 데이터 사용
- 치명적 오류 시 로그 기록 후 사용자 알림

### 6.4 보안 (Security)

**Phase 1 (로컬 실행)**:
- API 키는 환경 변수 또는 .env 파일 (git 제외)
- 민감 정보 로그 제외
- HTTPS 통신 (외부 API)

**Phase 2 이후**:
- 사용자 인증/인가
- 계좌 정보 암호화
- 정기 보안 감사

### 6.5 신뢰성 (Reliability)

**데이터 정합성**:
- 모든 에이전트 의견 DB 저장
- 토론 과정 전체 기록
- 버전 관리 (에이전트 프롬프트)

**에러 처리**:
```python
try:
    result = agent.analyze(ticker)
except LLMAPIError:
    log_error()
    retry(max_attempts=3)
except DataNotFoundError:
    return "데이터 부족으로 분석 불가"
except Exception as e:
    log_critical_error(e)
    alert_user()
```

### 6.6 유지보수성 (Maintainability)

**코드 품질**:
- Python Type Hints 사용
- Docstring 작성
- Unit Test 커버리지 > 70%

**문서화**:
- README.md (설치, 실행 방법)
- API 문서 (각 모듈)
- 에이전트 프롬프트 버전 관리

**모니터링**:
- 로깅: Python logging 모듈
- 성과 추적: DB에 예측 vs 실제 기록

---

## 7. Technical Requirements (기술 요구사항)

### 7.1 기술 스택

#### Backend
- **언어**: Python 3.11+
- **프레임워크**: 
  - FastAPI (향후 API 서버용, Phase 1에서는 선택)
  - Asyncio (비동기 처리)
- **LLM**:
  - Claude 3.5 Sonnet (조정자, 펀더멘털, 시장 분석)
  - Claude 3.5 Haiku (기술적 분석은 규칙 기반 보조)
- **에이전트 오케스트레이션**: 직접 구현 (Python dataclass + async)

#### Database
- **PostgreSQL**:
  - 에이전트 의견 저장
  - 토론 기록
  - 백테스팅 결과
- **Redis** (Phase 2):
  - 실시간 시세 캐싱
  - 분산 작업 큐

#### Data Sources
- **pykrx**: 과거 주가, 재무제표
- **한국투자증권 OpenAPI**: 실시간 시세
- **DART OpenAPI**: 공시, 재무제표

#### Frontend
- **Streamlit**: 웹 대시보드
- **Plotly**: 차트 시각화

#### Infrastructure (Phase 1 - 로컬)
- **개발 환경**: macOS / Linux
- **Python 가상환경**: venv 또는 conda
- **버전 관리**: Git + GitHub

#### Infrastructure (Phase 2 이후)
- **클라우드**: AWS 또는 GCP
- **컨테이너**: Docker
- **오케스트레이션**: Kubernetes (필요 시)

### 7.2 시스템 아키텍처

```
┌─────────────────────────────────────────────────────┐
│                  Streamlit UI                       │
│          (사용자 입력 & 결과 표시)                   │
└──────────────────────┬──────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────┐
│              Orchestrator (조정자)                   │
│         - 전체 워크플로우 관리                       │
│         - 에이전트 간 통신                           │
└──────────────────────┬──────────────────────────────┘
                       │
          ┌────────────┼────────────┐
          ▼            ▼            ▼
    ┌─────────┐  ┌─────────┐  ┌─────────┐
    │Agent 1  │  │Agent 2  │  │Agent N  │
    │(펀더멘  │  │(기술적) │  │(리스크) │
    │털)      │  │         │  │         │
    └────┬────┘  └────┬────┘  └────┬────┘
         │            │            │
         └────────────┼────────────┘
                      ▼
         ┌────────────────────────┐
         │   Claude API (LLM)     │
         └────────────────────────┘
                      ▲
                      │
         ┌────────────┴────────────┐
         │   Data Layer            │
         │ - pykrx                 │
         │ - 한국투자증권 API      │
         │ - DART API              │
         └─────────────────────────┘
                      ▲
                      │
         ┌────────────┴────────────┐
         │   PostgreSQL            │
         │ - 에이전트 의견         │
         │ - 토론 기록             │
         │ - 성과 추적             │
         └─────────────────────────┘
```

### 7.3 주요 컴포넌트

#### 7.3.1 Agent (Base Class)
```python
from abc import ABC, abstractmethod
from dataclasses import dataclass

@dataclass
class AgentOpinion:
    agent_name: str
    opinion: str  # "매수" / "중립" / "매도"
    score: int  # 0-100
    reasoning: list[str]  # 근거 3개
    timestamp: datetime

class BaseAgent(ABC):
    def __init__(self, name: str, llm_client):
        self.name = name
        self.llm = llm_client
        self.weight = 1.0  # 초기 가중치
    
    @abstractmethod
    async def analyze(self, ticker: str, data: dict) -> AgentOpinion:
        """종목 분석 (각 에이전트가 구현)"""
        pass
    
    def update_weight(self, performance: float):
        """성과 기반 가중치 업데이트"""
        self.weight *= (1 + performance * 0.1)
```

#### 7.3.2 Debate Engine
```python
class DebateEngine:
    def __init__(self, agents: list[BaseAgent]):
        self.agents = agents
    
    async def conduct_debate(self, ticker: str) -> DebateResult:
        # 1단계: 개별 분석 (병렬)
        opinions = await asyncio.gather(*[
            agent.analyze(ticker, data)
            for agent in self.agents
        ])
        
        # 2단계: 의견 제시
        self.log_opinions(opinions)
        
        # 3단계: 토론 (조건부)
        if self.needs_debate(opinions):
            opinions = await self.debate_rounds(opinions, max_rounds=3)
        
        # 4단계: 합의 도출
        consensus = self.calculate_consensus(opinions)
        
        # 5단계: 최종 결정
        final_decision = await self.moderator.make_decision(consensus)
        
        return DebateResult(
            opinions=opinions,
            consensus=consensus,
            final_decision=final_decision
        )
```

#### 7.3.3 Data Manager
```python
class DataManager:
    def __init__(self):
        self.cache = {}  # 간단한 메모리 캐시
    
    async def get_stock_data(self, ticker: str) -> StockData:
        # 캐시 확인
        if ticker in self.cache:
            return self.cache[ticker]
        
        # 데이터 수집
        ohlcv = self.fetch_pykrx_data(ticker)
        financials = self.fetch_dart_data(ticker)
        current_price = await self.fetch_realtime_price(ticker)
        
        data = StockData(
            ticker=ticker,
            ohlcv=ohlcv,
            financials=financials,
            current_price=current_price
        )
        
        # 캐싱
        self.cache[ticker] = data
        return data
```

### 7.4 API 설계 (Phase 2 준비)

**REST API Endpoints** (FastAPI):

```
POST /api/v1/analyze
{
  "ticker": "005930",
  "analysis_type": "full"  // or "quick"
}
→ Response: DebateResult

GET /api/v1/backtest
{
  "strategy": "default",
  "start_date": "2023-01-01",
  "end_date": "2025-12-31"
}
→ Response: BacktestResult

GET /api/v1/portfolio
→ Response: CurrentPortfolio (Phase 2)

POST /api/v1/order (Phase 2)
{
  "ticker": "005930",
  "quantity": 10,
  "price": 70000,
  "order_type": "limit"
}
→ Response: OrderResult
```

---

## 8. Data Requirements (데이터 요구사항)

### 8.1 데이터 소스

| 소스 | 수집 항목 | 주기 | 보관 기간 |
|------|-----------|------|-----------|
| **pykrx** | OHLCV, 재무제표, 수급 | 일 1회 (18:00) | 3년 |
| **한국투자증권** | 실시간 시세, 호가 | 실시간 | 1일 |
| **DART** | 공시, 사업보고서 | 실시간 모니터링 | 1년 |
| **뉴스** (Phase 2) | 주요 뉴스 | 1시간마다 | 1개월 |

### 8.2 데이터 모델 (ERD)

```sql
-- 종목 기본 정보
CREATE TABLE stocks (
    ticker VARCHAR(10) PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    sector VARCHAR(50),
    market VARCHAR(10),  -- 'KOSPI' or 'KOSDAQ'
    created_at TIMESTAMP DEFAULT NOW()
);

-- 일봉 데이터
CREATE TABLE daily_prices (
    id SERIAL PRIMARY KEY,
    ticker VARCHAR(10) REFERENCES stocks(ticker),
    date DATE NOT NULL,
    open INT,
    high INT,
    low INT,
    close INT,
    volume BIGINT,
    UNIQUE(ticker, date)
);

-- 에이전트 의견
CREATE TABLE agent_opinions (
    id SERIAL PRIMARY KEY,
    ticker VARCHAR(10) REFERENCES stocks(ticker),
    agent_name VARCHAR(50) NOT NULL,
    opinion VARCHAR(20),  -- '매수', '중립', '매도'
    score INT CHECK (score >= 0 AND score <= 100),
    reasoning JSONB,  -- 근거 배열
    created_at TIMESTAMP DEFAULT NOW()
);

-- 토론 기록
CREATE TABLE debates (
    id SERIAL PRIMARY KEY,
    ticker VARCHAR(10) REFERENCES stocks(ticker),
    round INT DEFAULT 1,
    opinions JSONB,  -- 전체 의견 스냅샷
    consensus_score INT,
    final_decision JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 백테스팅 결과
CREATE TABLE backtest_results (
    id SERIAL PRIMARY KEY,
    strategy_name VARCHAR(100),
    start_date DATE,
    end_date DATE,
    total_return FLOAT,
    sharpe_ratio FLOAT,
    mdd FLOAT,
    win_rate FLOAT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 성과 추적 (예측 vs 실제)
CREATE TABLE predictions (
    id SERIAL PRIMARY KEY,
    ticker VARCHAR(10) REFERENCES stocks(ticker),
    predicted_direction VARCHAR(20),  -- '상승', '하락'
    predicted_price INT,
    predicted_at TIMESTAMP,
    actual_price INT,
    actual_at TIMESTAMP,
    accuracy BOOLEAN,  -- 예측 맞았는지
    agent_opinions JSONB  -- 당시 에이전트 의견
);
```

### 8.3 데이터 거버넌스

**개인정보 처리**:
- Phase 1: 개인정보 수집 없음
- Phase 2: 계좌 정보 → 암호화 저장 (AES-256)

**데이터 보관 정책**:
- 주가 데이터: 3년 (백테스팅 용도)
- 에이전트 의견: 1년 (성과 추적)
- 로그: 3개월

---

## 9. User Experience (사용자 경험)

### 9.1 UI/UX 원칙

1. **투명성**: 모든 의사결정 과정을 보여줌
2. **단순성**: 복잡한 분석을 쉽게 이해할 수 있게
3. **신뢰성**: 불확실성을 명확히 전달
4. **반응성**: 빠른 피드백

### 9.2 주요 화면 플로우

```
[메인 화면]
    ↓ 종목 입력
[분석 진행 화면]
    ├─ 데이터 수집 중... (5초)
    ├─ 에이전트 분석 중... (20초)
    └─ 토론 중... (5초)
    ↓
[결과 화면]
    ├─ 에이전트 의견 카드 (5개)
    ├─ 토론 요약
    └─ 최종 결정 (진입가, 목표가, 손절가)
    ↓
[사용자 선택]
    ├─ 다른 종목 분석
    ├─ 백테스팅 보기
    └─ 상세 리포트 다운로드
```

### 9.3 에러 메시지

**사용자 친화적 에러**:
- ❌ "LLM API Error 429"
- ✅ "서버가 바쁩니다. 잠시 후 다시 시도해주세요."

**불확실성 표현**:
- ❌ "매수하세요"
- ✅ "매수 추천 (신뢰도 87%). 그러나 단기 과열 가능성이 있으니 주의하세요."

---

## 10. Cost Structure (비용 구조)

### 10.1 개발 비용 (Phase 1)

| 항목 | 비용 | 비고 |
|------|------|------|
| 개발 시간 | 2개월 | 본인 개발 (인건비 제외) |
| 도구/라이선스 | 0원 | 오픈소스 활용 |
| **합계** | **0원** | |

### 10.2 운영 비용 (Phase 1, 월간)

| 항목 | 월 비용 | 비고 |
|------|---------|------|
| **LLM API (Claude)** | 200,000원 | 일 10종목 × 20거래일 |
| 한국투자증권 API | 0원 | 무료 |
| pykrx | 0원 | 무료 (크롤링) |
| DART API | 0원 | 무료 |
| PostgreSQL (로컬) | 0원 | 로컬 설치 |
| **합계** | **~200,000원** | 목표 범위: 10-50만원 |

**LLM 비용 상세 계산**:
```
Claude 3.5 Sonnet 기준:
- Input: $3/M tokens
- Output: $15/M tokens

시나리오: 일 10종목 분석
- 종목당 평균 토큰 (5 에이전트):
  - Input: 3K tokens (데이터 + 프롬프트)
  - Output: 1K tokens (의견)
- 일 사용량: 10종목 × (3K input + 1K output) = 40K tokens
- 월 사용량: 40K × 20거래일 = 800K tokens
- 월 비용: (3×0.8 + 15×0.27) ≈ $6.45 ≈ 8,500원

실제 비용은 캐싱, 재시도 등으로 2-3배 증가 예상 → 월 2-3만원
```

**비용 절감 전략** 적용 시:
- 2단계 스크리닝: 분석 종목 50% 감소
- 프롬프트 캐싱: 90% 비용 절감 (캐싱 부분)
- **예상 실제 비용: 월 5-10만원** ✅ 목표 범위 내

### 10.3 Phase 2-3 비용 (참고)

**Phase 2** (반자동 매매):
- 서버 비용: AWS t3.medium (월 5만원)
- Redis: ElastiCache (월 3만원)
- 증가된 LLM 사용: 월 30-50만원
- **합계: 월 40-60만원**

**Phase 3** (완전 자동매매, 사용자 100명):
- 서버 스케일링: 월 30만원
- 데이터 구독 (뉴스 등): 월 20만원
- LLM API: 월 100-200만원
- **합계: 월 150-250만원**

---

## 11. Monetization Strategy (수익화 전략)

### 11.1 Phase별 전략

**Phase 1** (2개월): 무료
- 본인 사용 및 검증
- 성과 기록 축적

**Phase 2** (3-6개월): 클로즈 베타
- 지인 5-10명에게 무료 제공
- 피드백 수집
- 실계좌 성과 검증

**Phase 3** (6개월+): 정식 출시
- 프리미엄 구독 모델
- 무료 티어 제공 (제한적 기능)

### 11.2 가격 정책 (Phase 3 참고)

| 티어 | 월 가격 | 기능 |
|------|---------|------|
| **Free** | 0원 | 주 1회 분석, 백테스팅만 |
| **Basic** | 9,900원 | 일 5종목 분석, 알림 |
| **Pro** | 29,900원 | 무제한 분석, 반자동 매매 |
| **Premium** | 49,900원 | 완전 자동매매, 우선 지원 |

### 11.3 수익 예측 (Phase 3, 1년 후)

**보수적 시나리오**:
- 유료 사용자: 100명
- 평균 객단가: 월 20,000원
- 월 수익: 200만원
- 연 수익: 2,400만원
- 운영 비용: 연 2,000만원
- **순이익: 400만원/년**

**낙관적 시나리오**:
- 유료 사용자: 1,000명
- 평균 객단가: 월 25,000원
- 월 수익: 2,500만원
- 연 수익: 3억원
- 운영 비용: 연 5,000만원
- **순이익: 2.5억원/년**

---

## 12. Roadmap & Milestones (로드맵)

### 12.1 Phase 1: 분석 보조 도구 (2개월)

**Week 1-2: 기반 구축**
- [ ] 프로젝트 셋업 (Git, Python 환경)
- [ ] 데이터 수집 파이프라인 구현
  - [ ] pykrx 연동
  - [ ] 한국투자증권 API 연동
  - [ ] DART API 연동
- [ ] PostgreSQL 스키마 설계 및 구축
- [ ] 데이터 검증 로직 구현

**Week 3-4: 에이전트 구현**
- [ ] BaseAgent 추상 클래스
- [ ] 5개 에이전트 구현:
  - [ ] 기업 가치 분석 에이전트
  - [ ] 기술적 분석 에이전트
  - [ ] 시장 분석 에이전트
  - [ ] 리스크 관리 에이전트
  - [ ] 조정자 에이전트
- [ ] 에이전트 프롬프트 최적화
- [ ] Unit Test 작성

**Week 5-6: 토론 시스템**
- [ ] DebateEngine 구현
- [ ] 5단계 토론 프로토콜
- [ ] 합의 알고리즘
- [ ] 토론 과정 로깅

**Week 7: 백테스팅**
- [ ] 백테스팅 엔진 구현
- [ ] 거래 비용 반영
- [ ] Walk-forward 분석
- [ ] 성과 지표 계산

**Week 8: UI 및 통합**
- [ ] Streamlit 대시보드 구현
- [ ] 종목 분석 화면
- [ ] 백테스팅 대시보드
- [ ] 전체 통합 테스트
- [ ] 문서 작성 (README, API 문서)

**마일스톤 (M1)**: 2026-03-27
- ✅ 5개 에이전트 협업 작동
- ✅ 단일 종목 분석 < 30초
- ✅ 백테스팅 샤프 비율 ≥ 1.5
- ✅ Streamlit UI 완성

---

### 12.2 Phase 2: 반자동 매매 (3-6개월)

**목표**: 실전 검증 및 자동화 기반 구축

**주요 마일스톤**:
- M2.1 (1개월): Paper Trading 시뮬레이터 완성
- M2.2 (2개월): 장 전/장 중/장 후 루틴 구현
- M2.3 (3개월): 텔레그램 알림 시스템
- M2.4 (4개월): 승인 기반 자동 주문
- M2.5 (6개월): 소액 실계좌 테스트 (성과 목표: MDD < 10%)

---

### 12.3 Phase 3: 완전 자동매매 (6개월+)

**목표**: 수익 창출 시스템

**주요 마일스톤**:
- M3.1: 24시간 자율 운영
- M3.2: 멀티 전략 (데이트레이딩, 스윙, 모멘텀)
- M3.3: 사용자 계정 시스템
- M3.4: 구독 모델 오픈
- M3.5: 연 수익률 > 15%, 샤프 비율 > 2.0 달성

---

## 13. Risk Management (리스크 관리)

### 13.1 기술 리스크

| 리스크 | 확률 | 영향 | 완화 방안 |
|--------|------|------|-----------|
| LLM API 장애 | 중간 | 높음 | 재시도 로직, 폴백 모델 |
| 데이터 수집 실패 | 높음 | 중간 | 캐싱, 다중 소스 |
| 백테스팅 과적합 | 높음 | 높음 | Walk-forward, Out-of-sample |
| 에이전트 할루시네이션 | 중간 | 높음 | Tool 기반 데이터 제공 |

**완화 전략**:
1. **LLM API 장애**: Claude 장애 시 GPT-4로 자동 전환
2. **데이터 수집 실패**: 3회 재시도 후 캐시 데이터 사용
3. **과적합**: 학습 데이터와 테스트 데이터 엄격히 분리
4. **할루시네이션**: LLM은 해석만, 데이터는 Tool에서 제공

### 13.2 비즈니스 리스크

| 리스크 | 확률 | 영향 | 완화 방안 |
|--------|------|------|-----------|
| 성과 미달 | 중간 | 높음 | 보수적 목표 설정, 지속 개선 |
| LLM 비용 폭증 | 낮음 | 높음 | 2단계 스크리닝, 비용 모니터링 |
| 사용자 신뢰 상실 | 중간 | 높음 | 투명성, 불확실성 명시 |
| 시장 하락장 | 높음 | 중간 | 리스크 관리 에이전트 강화 |

**완화 전략**:
1. **성과 미달**: Phase 1에서 충분히 검증 후 Phase 2 진입
2. **비용 폭증**: 주간 비용 모니터링, 임계값 설정
3. **신뢰 상실**: 토론 과정 투명 공개, 손실 시 원인 분석 제공
4. **하락장**: 방어 모드 (현금 비중 증가, 손절 강화)

### 13.3 법적/규제 리스크

| 리스크 | 확률 | 영향 | 완화 방안 |
|--------|------|------|-----------|
| 자동매매 규제 | 낮음 | 중간 | 규정 모니터링, 컴플라이언스 |
| 투자 조언 규제 | 중간 | 높음 | 면책 조항, "참고 자료"로 명시 |
| 개인정보 유출 | 낮음 | 높음 | 암호화, 보안 감사 |

**완화 전략**:
1. **자동매매 규제**: 현재 합법, 규정 변경 시 즉시 대응
2. **투자 조언 규제**: 명확한 면책 조항, 금융투자업 미등록
3. **개인정보 유출**: Phase 1에서는 개인정보 없음, Phase 2부터 암호화

### 13.4 면책 조항 (Disclaimer)

```
⚠️ 중요 고지사항

1. 본 서비스는 투자 참고 자료일 뿐, 금융투자 조언이 아닙니다.
2. 모든 투자 결정은 사용자 본인의 판단과 책임하에 이루어집니다.
3. 과거 백테스팅 성과는 미래 수익을 보장하지 않습니다.
4. AI 에이전트의 분석에는 오류가 있을 수 있습니다.
5. 투자 손실에 대해 서비스 제공자는 책임지지 않습니다.
6. 투자 전 충분한 검토와 전문가 상담을 권장합니다.

본 서비스를 사용함으로써 위 사항에 동의하는 것으로 간주합니다.
```

---

## 14. Testing Strategy (테스트 전략)

### 14.1 테스트 범위

**Unit Test** (70% 커버리지 목표):
- 각 에이전트의 analyze() 메서드
- 데이터 수집 함수
- 백테스팅 로직
- 합의 알고리즘

**Integration Test**:
- 에이전트 간 협업
- 데이터 수집 → 분석 → 리포트 생성 전체 플로우
- API 연동 (한국투자증권, DART)

**End-to-End Test**:
- Streamlit UI에서 종목 입력 → 최종 리포트까지
- 백테스팅 실행 → 결과 대시보드

**Performance Test**:
- 종목 1개 분석 < 30초
- 백테스팅 (3년) < 5분
- 동시 요청 처리 (Phase 2)

### 14.2 백테스팅 방법론

**데이터 분할**:
```
전체 3년 (2023-01-01 ~ 2025-12-31)
├─ Training: 2023-01-01 ~ 2024-12-31 (2년)
├─ Validation: 2025-01-01 ~ 2025-06-30 (6개월)
└─ Test: 2025-07-01 ~ 2025-12-31 (6개월)
```

**Walk-forward 분석**:
```
Period 1: Train on 2023, Test on 2024 Q1
Period 2: Train on 2023-2024 Q1, Test on 2024 Q2
Period 3: Train on 2023-2024 Q2, Test on 2024 Q3
...
```

**거래 비용 반영**:
```python
def calculate_transaction_cost(price, quantity, order_type):
    commission = price * quantity * 0.00015  # 0.015%
    tax = price * quantity * 0.0023 if order_type == 'sell' else 0
    slippage = price * quantity * 0.001  # 0.1%
    return commission + tax + slippage
```

**검증 지표**:
- ✅ 샤프 비율 ≥ 1.5
- ✅ MDD ≤ 15%
- ✅ 승률 ≥ 60%
- ✅ KOSPI 대비 초과 수익률 ≥ 5%p

---

## 15. Success Criteria (성공 기준)

### 15.1 Phase 1 성공 기준 (2개월 후)

#### 정량적 지표

| 지표 | 목표 | 측정 방법 | 중요도 |
|------|------|-----------|--------|
| **백테스팅 샤프 비율** | ≥ 1.5 | 3년 백테스팅 | 높음 |
| **승률** | ≥ 60% | 추천 종목 2주 후 수익률 | 높음 |
| **KOSPI 대비 초과 수익** | ≥ 5%p | 연환산 수익률 비교 | 높음 |
| **MDD** | ≤ 15% | 백테스팅 최대 낙폭 | 높음 |
| **분석 시간** | < 30초 | 종목 1개 분석 완료 시간 | 중간 |
| **데이터 수집 성공률** | ≥ 95% | 수집 성공 / 전체 시도 | 중간 |

#### 정성적 지표

- ✅ 에이전트 토론 과정이 논리적이고 이해 가능
- ✅ 최소 3개 종목에서 실제 수익 발생 경험
- ✅ 분석 시간 50% 이상 절감 체감
- ✅ 자신 있게 다른 사람에게 추천할 수 있는 수준

#### 기술적 지표

- ✅ Unit Test 커버리지 > 70%
- ✅ 0 Critical 버그
- ✅ 시스템 가동률 > 99% (장 시간 기준)

### 15.2 평가 시점

**Week 8 (개발 완료 시)**:
- 백테스팅 성과 확인
- 기술적 지표 확인

**1개월 실사용 후**:
- 실제 추천 종목 성과 추적
- 사용자 경험 평가

**판단 기준**:
- 4개 이상 정량적 지표 달성 → **성공**
- 2-3개 달성 → **부분 성공**, 개선 후 Phase 2
- 1개 이하 → **실패**, 근본 원인 분석 후 재설계

---

## 16. Launch Plan (출시 계획)

### 16.1 Phase 1 출시 (개인 사용)

**개발 완료 (Week 8)**:
- [ ] 전체 기능 테스트 완료
- [ ] 문서 작성 (README, 설치 가이드)
- [ ] 백테스팅 결과 정리

**실사용 시작 (Week 9~)**:
- [ ] 주 1-2회 실제 종목 분석
- [ ] 성과 기록 (예측 vs 실제)
- [ ] 개선사항 도출

### 16.2 Phase 2 베타 테스트 (3개월 후)

**베타 참여자 모집**:
- 대상: 지인 중 주식 투자 경험자 5-10명
- 조건: 최소 3개월 사용 약속, 피드백 제공

**베타 기간**:
- 3개월 무료 사용
- 주간 피드백 수집
- 성과 비교 (베타 사용자 vs 일반 투자자)

### 16.3 Phase 3 정식 출시 (6개월 후)

**출시 전 준비**:
- [ ] 사용자 계정 시스템
- [ ] 결제 시스템 (PG 연동)
- [ ] 서버 인프라 구축 (AWS)
- [ ] 고객 지원 채널 (이메일, 채팅)

**마케팅**:
- 블로그/유튜브: 백테스팅 성과 공유
- 커뮤니티: 주식 관련 포럼, SNS
- 무료 체험: 2주 Free Trial

---

## 17. Monitoring & Feedback (모니터링 및 피드백)

### 17.1 성과 모니터링

**일일 체크**:
- 에이전트 추천 종목 기록
- 시스템 에러 확인

**주간 리뷰**:
- 추천 종목 성과 분석
- 에이전트별 정확도
- 비용 사용량 (LLM API)

**월간 리뷰**:
- 전체 성과 종합 (승률, 수익률, MDD)
- 에이전트 가중치 재조정
- 전략 개선 사항 도출

### 17.2 피드백 루프

```
1. 예측 기록
   ↓
2. 실제 결과 수집 (2주 후)
   ↓
3. 정확도 계산
   ↓
4. 에이전트 가중치 업데이트
   ↓
5. 프롬프트 개선 (필요 시)
   ↓
6. 다음 분석 반영
```

### 17.3 로깅

**로그 레벨**:
- INFO: 정상 동작 (분석 시작/완료)
- WARNING: 주의 필요 (데이터 지연, 재시도)
- ERROR: 오류 발생 (API 실패)
- CRITICAL: 치명적 오류 (시스템 다운)

**저장 위치**:
- 파일: `logs/roundtable_YYYYMMDD.log`
- DB: `agent_opinions`, `debates` 테이블

---

## 18. Appendix (부록)

### 18.1 용어 정리 (Glossary)

| 용어 | 설명 |
|------|------|
| **에이전트** | 특정 분야에 특화된 AI 분석 모듈 |
| **토론** | 에이전트 간 의견 교환 및 합의 과정 |
| **조정자** | 최종 의사결정을 내리는 에이전트 |
| **합의도** | 에이전트 의견의 일치 정도 (0-100점) |
| **백테스팅** | 과거 데이터로 전략 성과 검증 |
| **샤프 비율** | 위험 대비 수익률 (1.5 이상 우수) |
| **MDD** | 최대 낙폭 (Max DrawDown) |
| **슬리피지** | 주문가와 체결가의 차이 |
| **Walk-forward** | 학습→테스트를 반복하는 백테스팅 방법 |

### 18.2 참고 자료

**기술 문서**:
- [pykrx 공식 문서](https://github.com/sharebook-kr/pykrx)
- [한국투자증권 API 가이드](https://apiportal.koreainvestment.com/)
- [DART OpenAPI](https://opendart.fss.or.kr/)
- [Claude API 문서](https://docs.anthropic.com/)

**학습 자료**:
- "Algorithmic Trading" - Ernest P. Chan
- "Machine Learning for Asset Managers" - Marcos Lopez de Prado

**유사 프로젝트**:
- QuantConnect
- Alpaca
- AutoGen (Multi-Agent Framework)

### 18.3 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 2026-01-27 | 0.1 | 초안 작성 | Owner |

### 18.4 다음 단계

1. **즉시 (이번 주)**:
   - [ ] PRD 리뷰 및 피드백
   - [ ] 기술 스택 최종 확정
   - [ ] 개발 환경 셋업

2. **Week 1 시작 전**:
   - [ ] 아키텍처 상세 설계 문서 작성
   - [ ] DB 스키마 설계
   - [ ] 에이전트 프롬프트 초안 작성

3. **개발 시작**:
   - [ ] Git repository 생성
   - [ ] 프로젝트 구조 생성
   - [ ] 데이터 수집 파이프라인부터 시작

---

**문서 승인**:
- [ ] Product Owner 승인
- [ ] 기술 리뷰 완료
- [ ] 개발 착수 승인

**문서 상태**: Draft → Review 대기

---

**End of Document**
